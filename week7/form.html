<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>RESTFUL API UI</title>
    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
    <style>
      body {
        font-family: "Segoe UI", Arial, sans-serif;
        padding: 40px;
        background: linear-gradient(120deg, #232526, #414345);
        color: #fff;
        min-height: 100vh;
      }
      table {
        border-collapse: collapse;
        width: 100%;
        margin-bottom: 30px;
        box-shadow: 0 2px 8px rgba(0, 0, 0, 0.2);
        background: rgba(34, 34, 34, 0.95);
        border-radius: 8px;
        overflow: hidden;
      }
      th,
      td {
        padding: 12px 10px;
        border-bottom: 1px solid #444;
        text-align: left;
      }
      th {
        background: #111;
        color: #ffb347;
        font-size: 1.1em;
        letter-spacing: 1px;
      }
      tr:last-child td {
        border-bottom: none;
      }
      tr:hover td {
        background: #222831;
        transition: background 0.2s;
      }
      div {
        padding: 20px 25px;
        border-radius: 8px;
        background: rgba(34, 34, 34, 0.95);
        box-shadow: 0 2px 8px rgba(0, 0, 0, 0.15);
        margin-top: 20px;
        max-width: 400px;
      }
      h3 {
        margin-top: 0;
        color: #ffb347;
        letter-spacing: 1px;
      }
      input[type="text"],
      input[type="password"] {
        width: 95%;
        padding: 8px 10px;
        margin: 8px 0;
        border: none;
        border-radius: 4px;
        background: #222831;
        color: #fff;
        font-size: 1em;
        box-shadow: 0 1px 2px rgba(0, 0, 0, 0.08);
      }
      input[type="text"]:focus,
      input[type="password"]:focus {
        outline: none;
        background: #393e46;
      }
      button {
        background: linear-gradient(90deg, #ffb347, #ffcc33);
        color: #232526;
        border: none;
        border-radius: 4px;
        padding: 10px 22px;
        font-size: 1em;
        margin-right: 10px;
        font-weight: bold;
        cursor: pointer;
        margin-top: 10px;
        box-shadow: 0 1px 4px rgba(0, 0, 0, 0.1);
        transition: background 0.2s, color 0.2s;
      }
      button:hover {
        background: linear-gradient(90deg, #ffcc33, #ffb347);
        color: #111;
      }
      td {
        margin: auto;
      }
    </style>
  </head>
  <body>
    <table id="UserTable">
      <thead>
        <tr>
          <th>ID</th>
          <th>Name</th>
          <th>Password</th>
          <th>CreateAt</th>
          <th>Actions</th>
        </tr>
      </thead>
      <tbody id="content"></tbody>
    </table>
    <div>
      <h3>Add/Update User</h3>
      <input type="text" id="userId" placeholder="ID" />
      <input type="text" id="userName" />
      <input type="text" id="userPassword" />
      <button onclick="SaveUser()">Save</button>
    </div>
  </body>
  <script>
    const apiURL = "restful.php/users";
    async function fetchUsers() {
      try {
        const res = await axios.get(apiURL);
        console.log(res.data);
        const tbody = document.getElementById("content");
        tbody.innerHTML = "";
        res.data.forEach((users) => {
          const row = tbody.insertRow();
          for (const key in users) {
            const cell = row.insertCell();
            const text = document.createTextNode(users[key]);
            cell.appendChild(text);
          }
          const actionCell = row.insertCell();
          const buttons = [
            {
              label: "Edit",
              action: () => {
                editUser(users.id, users.name, users.password);
              },
            },
            {
              label: "Delete",
              action: () => {
                deleteUser(users.id);
              },
            },
          ];
          buttons.forEach(({ label, action, className }) => {
            const btn = document.createElement("button");
            btn.textContent = label;
            btn.onclick = action;
            if (className) btn.className = className;
            actionCell.appendChild(btn);
          });
        });
      } catch (error) {
        console.error("Failed to fetch users Data", error);
        alert("Error loading users");
      }
    }
    fetchUsers();
    function resetForm() {
      document.getElementById("userId").value = "";
      document.getElementById("userName").value = "";
      document.getElementById("userPassword").value = "";
    }

    function editUser(id, name, password) {
      document.getElementById("userId").value = id;
      document.getElementById("userName").value = name;
      document.getElementById("userPassword").value = password;
    }
    async function SaveUser() {
      const id = document.getElementById("userId").value;
      const name = document.getElementById("userName").value;
      const password = document.getElementById("userPassword").value;

      if (!name || !password) return alert("Please fill all fields.");
      const data = { name, password };
      if (id) data.id = id;
      try {
        if (id) {
          try {
            await axios.put(`${apiURL}/${id}`, data);
          } catch (e) {
            await axios.post(apiURL, data);
          }
        } else {
          await axios.post(apiURL, data);
        }
        fetchUsers();
        resetForm();
      } catch (error) {
        console.error("Save Failed", error);
        alert("Fail to save user");
      }
    }

    async function deleteUser(id) {
      if (!confirm("Are you sure you want to delete this user?")) return;
      try {
        await axios.delete(`${apiURL}/${id}`);
        fetchUsers();
        resetForm();
      } catch (error) {
        console.error("Delete Failed", error);
        alert("Fail to delete user");
      }
    }
  </script>
</html>
